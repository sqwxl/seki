{% extends "base.html" %}
{% block flash %}
    {% if let Some(msg) = flash %}<div class="flash">{{ msg }}</div>{% endif %}
{% endblock %}
{% block content %}
    <h1>Start a new go game</h1>
    <form action="/games" method="post">
        <fieldset>
            <legend>Game settings</legend>
            <div>
                <label for="cols">Board size</label>
                <input type="number"
                       name="cols"
                       id="cols"
                       min="4"
                       max="19"
                       step="1"
                       value="19">
            </div>
            <div>
                <label for="komi">Komi</label>
                <input type="number"
                       name="komi"
                       id="komi"
                       min="0.5"
                       max="10.5"
                       step="0.5"
                       value="0.5">
            </div>
            <div>
                <label for="handicap">Handicap</label>
                <input type="number"
                       name="handicap"
                       id="handicap"
                       min="1"
                       max="9"
                       step="1"
                       value="1">
            </div>
            <div>
                <label for="allow_undo">Allow takebacks</label>
                <input type="checkbox" name="allow_undo" id="allow_undo" value="true">
            </div>
        </fieldset>
        <fieldset>
            <legend>Time control</legend>
            <div>
                <label><input type="radio" name="time_control" value="none" checked> None</label>
                <label><input type="radio" name="time_control" value="fischer"> Fischer</label>
                <label><input type="radio" name="time_control" value="byoyomi"> Byo-yomi</label>
                <label><input type="radio" name="time_control" value="correspondence"> Correspondence</label>
            </div>
            <div id="tc-fischer" style="display: none">
                <div>
                    <label for="main_time_minutes">Main time (minutes)</label>
                    <input type="number" name="main_time_minutes" id="main_time_minutes" min="1" max="180" value="10" disabled>
                </div>
                <div>
                    <label for="increment_secs">Increment (seconds)</label>
                    <input type="number" name="increment_secs" id="increment_secs" min="0" max="60" value="5" disabled>
                </div>
            </div>
            <div id="tc-byoyomi" style="display: none">
                <div>
                    <label for="byo_main_time_minutes">Main time (minutes)</label>
                    <input type="number" name="main_time_minutes" id="byo_main_time_minutes" min="0" max="180" value="20" disabled>
                </div>
                <div>
                    <label for="byoyomi_time_secs">Period time (seconds)</label>
                    <input type="number" name="byoyomi_time_secs" id="byoyomi_time_secs" min="5" max="120" value="30" disabled>
                </div>
                <div>
                    <label for="byoyomi_periods">Periods</label>
                    <input type="number" name="byoyomi_periods" id="byoyomi_periods" min="1" max="10" value="3" disabled>
                </div>
            </div>
            <div id="tc-correspondence" style="display: none">
                <div>
                    <label for="correspondence_days">Days per move</label>
                    <input type="number" name="correspondence_days" id="correspondence_days" min="1" max="14" value="3" disabled>
                </div>
            </div>
            <script>
                function toggleTC(value) {
                    ['tc-fischer', 'tc-byoyomi', 'tc-correspondence'].forEach(id => {
                        const section = document.getElementById(id);
                        const active = id === 'tc-' + value;
                        section.style.display = active ? '' : 'none';
                        section.querySelectorAll('input').forEach(input => { input.disabled = !active; });
                    });
                }
                document.querySelectorAll('input[name="time_control"]').forEach(radio => {
                    radio.addEventListener('change', () => toggleTC(radio.value));
                });
            </script>
        </fieldset>
        <fieldset>
            <legend>Your color</legend>
            <label for="color_black">âš«</label>
            <input type="radio" name="color" value="black" id="color_black" checked>
            <label for="color_white">âšª</label>
            <input type="radio" name="color" value="white" id="color_white">
            <label for="color_nigiri">ðŸŽ²</label>
            <input type="radio" name="color" value="nigiri" id="color_nigiri">
        </fieldset>
        <fieldset>
            <legend>Notifications</legend>
            <div>
                <label for="is_private">Private game? (no spectators allowed)</label>
                <input type="checkbox" name="is_private" id="is_private" value="true">
            </div>
            <div>
                <label for="email">Get notified when it's your turn to play (optional)</label>
                <input type="email"
                       name="creator_email"
                       id="creator_email"
                       placeholder="your@email.com">
            </div>
            <div>
                <label for="invite_email">
                    Invite a friend (optional; you can also share the game URL with them once it's been created)
                </label>
                <input type="email"
                       name="invite_email"
                       id="invite_email"
                       placeholder="friend@email.com">
            </div>
        </fieldset>
        <button type="submit">Create Game</button>
    </form>
{% endblock %}
