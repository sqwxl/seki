{% extends "base.html" %}
{% block title %}{{ profile_username }} - Seki{% endblock %}
{% block flash %}
    {% if let Some(msg) = flash %}<div class="flash">{{ msg }}</div>{% endif %}
{% endblock %}
{% block content %}
    <div style="width:100%">
        <h1>{{ profile_username }}</h1>
        <h2>Games</h2>
        <div id="user-games" data-initial-games="{{ initial_games }}"></div>
        {% if is_own_profile %}
            <section>
                <h2>Settings</h2>
                {% if user_is_registered %}
                    <h3>Username</h3>
                    <form action="/users/{{ profile_username }}" method="post">
                        <input type="text"
                               name="username"
                               value="{{ profile_username }}"
                               maxlength="30">
                        <button type="submit">Update</button>
                    </form>
                    <h3>API Token</h3>
                    <p>
                        Use this token to authenticate with the API via <code>Authorization: Bearer &lt;token&gt;</code>.
                    </p>
                    <form action="/settings/token" method="post">
                        {% if let Some(token) = api_token %}
                            <div>
                                <input type="text"
                                       value="{{ token }}"
                                       readonly
                                       style="width:24ch;
                                              font-family:monospace">
                            </div>
                            <button type="submit">Regenerate Token</button>
                        {% else %}
                            <button type="submit">Generate Token</button>
                        {% endif %}
                    </form>
                {% else %}
                    <p>
                        <a href="/register">Register</a> to access API tokens and other settings.
                    </p>
                {% endif %}
            </section>
        {% endif %}
    </div>
{% endblock %}
