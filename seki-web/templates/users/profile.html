{% extends "base.html" %}
{% block title %}{{ profile_username }} - Seki{% endblock %}
{% block og %}
<meta property="og:site_name" content="Seki">
<meta property="og:type" content="website">
<meta property="og:title" content="{{ profile_username }} â€” Seki">
<meta property="og:description" content="{{ profile_username }}'s Go profile on Seki">
{% endblock %}
{% block flash %}
    {% if let Some(msg) = flash %}<div class="flash">{{ msg }}</div>{% endif %}
{% endblock %}
{% block content %}
    <div style="width:100%">
        <h1 style="display:flex;align-items:center;gap:0.5em">
            {{ profile_username }}
            {% if !is_own_profile %}
                <a href="/?opponent={{ profile_username }}" class="btn"
                   style="font-size:0.5em;text-decoration:none;border:1px solid var(--border);border-radius:4px;background:var(--bg-muted);color:var(--fg)">Challenge</a>
            {% endif %}
        </h1>
        <h2>Games</h2>
        <div id="user-games" data-initial-games="{{ initial_games }}"></div>
        {% if is_own_profile %}
            <section>
                <h2>Settings</h2>
                {% if user_is_registered %}
                    <h3>Username</h3>
                    <form action="/users/{{ profile_username }}" method="post" class="inline-form">
                        <input type="text"
                               name="username"
                               value="{{ profile_username }}"
                               maxlength="30">
                        <button type="submit">Update</button>
                    </form>
                    <h3>API Token</h3>
                    <p>
                        Use this token to authenticate with the API via <code>Authorization: Bearer &lt;token&gt;</code>.
                    </p>
                    <form action="/settings/token" method="post" class="inline-form">
                        {% if let Some(token) = api_token %}
                            <input type="text"
                                   value="{{ token }}"
                                   readonly
                                   style="font-family:monospace">
                            <button type="submit">Regenerate Token</button>
                        {% else %}
                            <button type="submit">Generate Token</button>
                        {% endif %}
                    </form>
                {% else %}
                    <p>
                        <a href="/register">Register</a> to access API tokens and other settings.
                    </p>
                {% endif %}
            </section>
        {% endif %}
    </div>
{% endblock %}
